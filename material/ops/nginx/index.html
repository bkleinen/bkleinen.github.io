<!doctype html><html><head><title>Nginx - Prof. Dr. Barne Kleinen</title><link rel=icon href=https://bkleinen.github.io//favicon.ico>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=https://bkleinen.github.io/css/styles.min.css media=screen></head><body><div class=container-fluid><header class="row m-b-5"><div class="col-md-2 c2">&nbsp;</div><div class="col-md-10 c1 p-2"><div class=container-flex><div class=row><div class=col-9><h1 class="c5 title">Prof. Dr. Barne Kleinen</h1><small>Website of Prof. Dr. Barne Kleinen, Professor for Media Informatics
(<a href=https://imi-bachelor.htw-berlin.de>Bachelor</a>/<a href=https://imi-master.htw-berlin.de>Master</a>)
at <a href=https://www.htw-berlin.de>HTW Berlin</a></small></div><div class=col-3><a href=https://www.htw-berlin.de><img src=https://bkleinen.github.io//images/htw_logo_green.gif alt="HTW Berlin" title="HTW Berlin"></a><br><a href=https://bkleinen.github.io//>Programming and Web Technology @ IMI</a></div></div></div></div></header><main class="row p-0"><nav class="col-md-2 c2"><div class=nav><ul class="nav flex-md-column"><li class=nav-item></li><li class=nav-item><a class=nav-link href=https://bkleinen.github.io/><div>Home</div></a></li><li class=nav-item><a class=nav-link href=https://bkleinen.github.io/classes/ws2024/><div>Classes</div></a></li><li class=nav-item><a class="nav-link active" href=https://bkleinen.github.io/material/><div>Material</div></a></li><li class=nav-item><a class=nav-link href=https://bkleinen.github.io/software_projects/><div>Software Projects</div></a></li><li class=nav-item><a class="nav-link dropdown-toggle" data-bs-toggle=dropdown href=# role=button aria-expanded=false>Studies</a><div class=dropdown-menu><a class=dropdown-item href=https://bkleinen.github.io/studies/thesis/>Thesis</a>
<a class=dropdown-item href=https://bkleinen.github.io/studies/ic/>IC</a>
<a class=dropdown-item href=https://bkleinen.github.io/studies/bafoeg/>Bafoeg</a>
<a class=dropdown-item href=https://bkleinen.github.io/studies/grading/>Grading Info</a></div></li><li class=nav-item><a class="nav-link dropdown-toggle" data-bs-toggle=dropdown href=# role=button aria-expanded=false>Misc</a><div class=dropdown-menu><a class=dropdown-item href=https://bkleinen.github.io/misc/links/>Links to frequently used pages</a>
<a class=dropdown-item href=https://bkleinen.github.io/misc/trans/>Trans@HTW</a>
<a class=dropdown-item href=https://bkleinen.github.io/misc/lsf/>Email Collector for LSF</a></div></li><li class=nav-item><a class=nav-link href=https://bkleinen.github.io/contact/><div>Contact Info</div></a></li><ul></div></nav><div class="col-md-10 c3"><div class=outer><nav aria-label=breadcrumb role=navigation><ol class="breadcrumb breadcrumb-thin"><li class=breadcrumb-item><a href=https://bkleinen.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://bkleinen.github.io/material/>material</a></li><li class=breadcrumb-item><a href=https://bkleinen.github.io/material/ops/>ops</a></li><li class="breadcrumb-item active" aria-current=page>nginx</li></ol></nav></div><div class=coursenav></div><div class=container-fluid><h1>Nginx</h1><small><a href=https://bkleinen.github.io/material/>Material</a>
in
&nbsp;
<i><a href=https://bkleinen.github.io/courses/>Courses</a></i>:
<a href=https://bkleinen.github.io/material/courses/networks/>Networks</a>
<a href=https://bkleinen.github.io/material/courses/wt1/>Wt1</a>
&nbsp;
<i><a href=https://bkleinen.github.io/tags/>Tags</a></i>:
<a href=https://bkleinen.github.io/material/tags/web/>Web</a>
&nbsp;
<i><a href=https://bkleinen.github.io/tools/>Tools</a></i>:
<a href=https://bkleinen.github.io/material/tools/nginx/>Nginx</a></small><header><a data-bs-toggle=collapse href=#tocContent role=button aria-expanded=false aria-controls=tocContent>Table of Contents</a></header><div class=collapse id=tocContent><nav id=TableOfContents><ul><li><a href=#nginx>nginX</a><ul><li><a href=#notes--macos>Notes / MacOs</a></li></ul></li><li><a href=#https>HTTPS</a><ul><li><a href=#generate-a-self-signed-certificate>Generate a self signed certificate</a></li><li><a href=#create-ssl-server-block>Create SSL server block</a></li><li><a href=#test-config--restart-nginx>Test Config & Restart Nginx</a></li><li><a href=#open-port-443-in-the-firewall>Open Port 443 in the firewall</a></li></ul></li></ul></nav></div><h2 id=nginx>nginX</h2><ul><li>Website: <a href=https://nginx.org/>https://nginx.org/</a></li><li>Documentation: <a href=https://nginx.org/en/docs/>https://nginx.org/en/docs/</a></li><li>Download: <a href=https://nginx.org/en/download.html>nginx: download</a></li><li>Installation: <a href=https://nginx.org/en/docs/install.html>https://nginx.org/en/docs/install.html</a><ul><li>Windows: <a href=http://nginx.org/en/docs/windows.html>http://nginx.org/en/docs/windows.html</a></li><li></li></ul></li><li>Beginner&rsquo;s guide: <a href=http://nginx.org/en/docs/beginners_guide.html>http://nginx.org/en/docs/beginners_guide.html</a></li></ul><p>ءBy default, the configuration file is named nginx.conf and placed in the
directory <code>/usr/local/nginx/conf</code>, <code>/etc/nginx</code>, or <code>/usr/local/etc/nginx</code>.</p><h3 id=notes--macos>Notes / MacOs</h3><ul><li><p>installation with homebrew:</p><pre><code>  brew install nginx
</code></pre></li><li><p>start nginx</p><pre><code>  nginx -s
</code></pre></li><li><p>Where signal may be one of the following:</p><pre><code>  stop — fast shutdown
  quit — graceful shutdown
  reload — reloading the configuration file
  reopen — reopening the log files
</code></pre></li><li><p>put configuration under version control:</p><pre><code>  cd /usr/local/etc/nginx
  git init
  git add .
  git commit -m &quot;generated configuration&quot;
</code></pre></li></ul><h2 id=https>HTTPS</h2><p>To set up a secure connection via https, you need to obtain a certificate and
a key. For staging servers as ours, using a self-signed certificate is an option.</p><p>Your browser will issue a warning when you access the site, however, and you need
to adjust the browser&rsquo;s security settings resp. configure an exception for your
site (try it with my site: )</p><p>You need to</p><ul><li>generate or obtain the certificate and key</li><li>put them on the server (or generate them directly on the server)</li><li>configure a nginx server block with <code>listen 443 ssl;</code> and configure
the correct path to your certificate + key</li><li>restart nginx</li><li>open port 443 in the firewall</li></ul><p>If you want to understand what you are doing, here are some links</p><ul><li>a brief video: <a href="https://www.youtube.com/watch?v=T4Df5_cojAs">How does HTTPS work? What&rsquo;s a CA? What&rsquo;s a self-signed Certificate? - YouTube</a></li><li>another tutorial: <a href=https://devcenter.heroku.com/articles/ssl-certificate-self>Creating a Self-Signed SSL Certificate | Heroku Dev Center</a></li><li>and more background: <a href="https://www.youtube.com/watch?v=q1OF_0ICt9A">14. SSL and HTTPS - YouTube</a></li></ul><h3 id=generate-a-self-signed-certificate>Generate a self signed certificate</h3><p>e.g. with (note the output file names in the command:)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>    $ openssl req -x509 -nodes -days <span class=m>365</span> -newkey rsa:2048 -keyout ./nginx-selfsigned.key -out ./nginx-selfsigned.crt
</span></span></code></pre></div><p>Note: instead of using a self-signed certificate, you can aquire one from Certbot:
<a href="https://certbot.eff.org/instructions?ws=nginx&amp;os=debian-10">Certbot Instructions | Certbot</a></p><h3 id=create-ssl-server-block>Create SSL server block</h3><p>See <a href=https://github.com/htw-imi-networks/example-config/commit/fbef03b8dcd571bb641c20a5f325992c800ed919>this commit</a> for an example. The key parts are:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>     listen <span class=m>443</span> ssl<span class=p>;</span>
</span></span><span class=line><span class=cl>     ...
</span></span><span class=line><span class=cl>     ssl_certificate     /home/local/ssl-selfsigned/nginx-selfsigned.crt
</span></span><span class=line><span class=cl>     ssl_certificate_key /home/local/ssl-selfsigned/nginx-selfsigned.key
</span></span></code></pre></div><p>Note that these are absolute file paths that need to match your actual location,
and that you would put them in a more central location for a &ldquo;real&rdquo; server config.</p><h3 id=test-config--restart-nginx>Test Config & Restart Nginx</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>    $ sudo nginx -t
</span></span><span class=line><span class=cl>    $ sudo systemctl restart nginx
</span></span></code></pre></div><h3 id=open-port-443-in-the-firewall>Open Port 443 in the firewall</h3><p>Die Firewall auf den Debian-Servern wird mit diesem Script konfiguriert:</p><p><code>/root/firewall.sh</code></p><p>finden Sie diese Zeilen und entfernen Sie die Kommentare:
(oben im Script ist auch eine Anleitung; bei der Gelegenheit können Sie
auch die Ports 80 für http und 22 für ssh nach aussen aufmachen)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># kommentare wegnehmen: HTTPS INPUT OUTPUT zulassen</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp --dport <span class=m>443</span> -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A OUTPUT -p tcp --dport <span class=m>443</span> -j ACCEPT
</span></span></code></pre></div><p>dann das script ausführen:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo /root/firewall.sh
</span></span></code></pre></div><p>und ausprobieren!</p><h1 id=heading></h1><script src=https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></div></div></div></main><footer class="row p-0"><div class="col-md-2 c2">&nbsp;</div><div class="col-md-10 c4"><small><hr><div class=container-fluid><div class=row><div class=col-9><a href=https://bkleinen.github.io//contact>Prof. Dr. Barne Kleinen</a>,
<a href=https://www.htw-berlin.de>HTW Berlin</a>,
<a href=https://www.f4.htw-berlin.de/>FB4</a>, <a href=https://imi-bachelor.htw-berlin.de/>International Media and Computing</a>.
&nbsp;&nbsp;&dash;&nbsp;&nbsp;</div><div class=col-3><a href=https://bkleinen.github.io//contact/impressum>Impressum</a>,
<a href=https://bkleinen.github.io//contact/datenschutzerklaerung>Datenschutzerklärung</a></div></div><div class=row><div class=col-9>This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/>Creative Commons Attribution-NonCommercial 4.0 International License</a>.<br><small>This page was authored by: map[name:Barne Kleinen]</small></div><div class=col-3><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img alt="Creative Commons Licence" style=border-width:0 src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png></a></div></div><div class=row><div class=col-sm-12></div></div></div></small></div></footer><script>let sortTables=!1,stripedTables=!0</script><script src=https://bkleinen.github.io/js/bundle.min.e133eae943f4d1cb473481e473689ee73e9f6880b33894730d0b3c8f682d034e.js defer></script></body></html>